<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="./img/fav.jpg" type="image/png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kewpie Much & More เพราะคิวพีเป็นได้มากกว่าน้ำสลัด</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./animate.css">
</head>
<body class="page page-form">
    <div class="wrapper">
        <img src="./img/logo.png" class="logo animate__animated animate__bounceIn" />
        <form id="myForm">
            <h3>โปรดกรอกข้อมูล</h3>
            <div class="form-group">
                <select class="required" name="gender">
                    <option value="">เพศ</option>
                    <option value="ชาย">ชาย</option>
                    <option value="หญิง">หญิง</option>
                    <option value="ไม่ระบุ">ไม่ระบุ</option>
                </select>
                <span class="error-message" style="display: none;">กรุณาเลือกเพศ</span>

                <svg class="star" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 726.02 704.23">
                    <path fill="red" d="M726.02,395.82h-259.48l175.41,175.41-57.94,57.93-178.74-178.74v253.82h-81.89v-250.77l-186.15,186.15-61.71-61.71,182.08-182.08H0v-87.41h263.4L86.1,131.11l57.94-57.93,179.33,179.47V0h81.89v248.01l183.54-183.54,61.71,61.85-182.08,182.09h257.59v87.41Z"/>
                </svg>
                <svg class="arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"/>
                </svg>
            </div>

            <div class="form-group">
                <input type="number" placeholder="อายุ" name="age" required />
                <svg class="star" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 726.02 704.23">
                    <path fill="red" d="M726.02,395.82h-259.48l175.41,175.41-57.94,57.93-178.74-178.74v253.82h-81.89v-250.77l-186.15,186.15-61.71-61.71,182.08-182.08H0v-87.41h263.4L86.1,131.11l57.94-57.93,179.33,179.47V0h81.89v248.01l183.54-183.54,61.71,61.85-182.08,182.09h257.59v87.41Z"/>
                </svg>
            </div>

            <div class="form-group">
                <select class="required" name="kewpie">
                    <option value="">เคยกินน้ำสลัดของ KEWPIE หรือไม่</option>
                    <option value="เคย">เคย</option>
                    <option value="ไม่เคย">ไม่เคย</option>
                </select>
                <span class="error-message" style="display: none;">กรุณาเลือกตัวเลือกนี้</span>

                <svg class="star" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 726.02 704.23">
                    <path fill="red" d="M726.02,395.82h-259.48l175.41,175.41-57.94,57.93-178.74-178.74v253.82h-81.89v-250.77l-186.15,186.15-61.71-61.71,182.08-182.08H0v-87.41h263.4L86.1,131.11l57.94-57.93,179.33,179.47V0h81.89v248.01l183.54-183.54,61.71,61.85-182.08,182.09h257.59v87.41Z"/>
                </svg>
                <svg class="arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"/>
                </svg>
            </div>

            <div class="form-group">
                <select class="required" name="preference">
                    <option value="">นิยมนำน้ำสลัดมาประกอบอาหารประเภทใด</option>
                    <option value="สลัด">สลัด</option>
                    <option value="หมัก">หมัก</option>
                    <option value="ผัด">ผัด</option>
                    <option value="ราด">ราด</option>
                    <option value="จิ้ม">จิ้ม</option>
                    <option value="จุ่ม">จุ่ม</option>

                </select>
                <span class="error-message" style="display: none;">กรุณาเลือกตัวเลือกนี้</span>

                <svg class="star" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 726.02 704.23">
                    <path fill="red" d="M726.02,395.82h-259.48l175.41,175.41-57.94,57.93-178.74-178.74v253.82h-81.89v-250.77l-186.15,186.15-61.71-61.71,182.08-182.08H0v-87.41h263.4L86.1,131.11l57.94-57.93,179.33,179.47V0h81.89v248.01l183.54-183.54,61.71,61.85-182.08,182.09h257.59v87.41Z"/>
                </svg>
                <svg class="arrow" xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chevron-down" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"/>
                </svg>
            </div>

            <div class="form-group consent">
                <label>
                    <input type="checkbox" name="consent" required>
                    ท่านยินยอมให้ผู้จัดงานจัดเก็บ ใช้ และ/หรือ เปิดเผยข้อมูลส่วนตัวบุคคลของตน อันได้แก่ รูปภาพ เสียง วิดีโอ ข้อมูล เนื้อหา และข้อมูลส่วนบุคคลอื่นๆ ที่เกี่ยวข้องกับการเข้าร่วมกิจกรรมนี้ เพื่อนำไปใช้ในการโฆษณาและประชาสัมพันธ์กิจกรรมนี้ผ่านแพลตฟอร์มออนไลน์และช่องทางสื่อต่าง ๆ ทั้งที่มีอยู่ในปัจจุบันและอนาคตของ KEWPIE หรือไม่
                </label>
            </div>
            <button type="submit" class="btn-submit">
                <img src="./img/next-btn.png" />
            </button>
        </form>
    </div>
    <img src="./img/sink.png"  class="bg-sink" />

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('myForm');
    if (!form) {
        console.error('Form not found');
        return;
    }

    form.addEventListener('submit', function(event) {
        event.preventDefault();
        console.log('Form submitted');

        const selectElements = document.querySelectorAll('.required');
        let isFormValid = true;

        selectElements.forEach(function(selectElement) {
            const errorMessage = selectElement.nextElementSibling;
            if (selectElement.value === '') {
                errorMessage.style.display = 'inline';
                isFormValid = false;
            } else {
                errorMessage.style.display = 'none';
            }
        });

        if (isFormValid) {
            console.log('Form is valid, preparing to send data');
            const formData = new FormData(form);
            const formObject = {
                page: 'intro-form',
                gender: formData.get('gender'),
                age: formData.get('age'),
                kewpie: formData.get('kewpie'),
                preference: formData.get('preference'),
                consent: formData.get('consent')
            };
            
            const deployKey = 'AKfycbzuFaEBCqHJE4dMsnnhV6VKD2qHEdd8GdTQB9gKEyxovThSQjyWrjco142hMXqXQOXj';
            const url = 'https://script.google.com/macros/s/AKfycbzuFaEBCqHJE4dMsnnhV6VKD2qHEdd8GdTQB9gKEyxovThSQjyWrjco142hMXqXQOXj/exec';
            
            console.log('Sending data to:', url);
            fetch(url, {
                method: 'POST',
                body: JSON.stringify({ data: formObject }),
                headers: {
                    'Content-Type': 'application/json',
                },
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    console.log('Data submitted successfully');
                    sessionStorage.setItem('formData', JSON.stringify(formObject));
                    window.location.href = 'step1.html';
                } else {
                    throw new Error('Failed to submit data');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred. Please try again.');
            });
        } else {
            console.log('Form is not valid');
        }
    });
});
</script>
</body>
</html>
