<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="./img/fav.jpg" type="image/png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kewpie Much & More เพราะคิวพีเป็นได้มากกว่าน้ำสลัด</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./animate.css">
</head>
<body class="page page-step1">
    <div class="wrapper" >
        <img src="./img/text-2.png" class="img-text animate__animated animate__bounceIn" />
        
        <div class="shelf">
            <div class="shelf-item">
                <img src="./img/bowl-1.png" id="bowl-1" data-name="หอม อร่อย ลงตัว" class="animate__animated animate__fadeInLeft" />
                <img src="./img/bowl-2.png" id="bowl-2" data-name="จี๊ดจ๊าดโดนใจ" class="animate__animated animate__fadeInLeft" />
            </div>
            <div class="shelf-item">
                <img src="./img/bowl-3-sold.png" id="bowl-3" style="pointer-events: none;" data-name="อร่อยเด่น มีสไตล์" class="animate__animated animate__fadeInLeft" />
                <img src="./img/bowl-4.png" id="bowl-4" style="pointer-events: none;" data-name="เข้มข้น แบบจัดเต็ม" class="animate__animated animate__fadeInLeft" />
            </div>
            <div class="shelf-item">
                <img src="./img/bowl-5-sold.png" id="bowl-5" style="pointer-events: none;" data-name="เติมเต็มความสดชื่น" class="animate__animated animate__fadeInLeft" />
                <img src="./img/bowl-6-sold.png" id="bowl-6" style="pointer-events: none;" data-name="สดใส สายไดเอท" class="animate__animated animate__fadeInLeft" />
            </div>
            <div class="shelf-item">
                <img src="./img/bowl-7.png" id="bowl-7" data-name="อร่อยเต็มรสเครื่องเทศ" class="animate__animated animate__fadeInLeft" />
                <img src="./img/bowl-8.png" id="bowl-8" data-name="หอมละมุน มีระดับ" class="animate__animated animate__fadeInLeft" />
            </div>
        </div>

        <img src="./img/bowl-animated.gif" id="activeEffect" class="active-effect">
        <img src="" id="activeBowl" class="active-bowl">

        <button class="btn-submit" onclick="goToNextPage()">
            <img src="./img/next-btn.png" />
        </button>

    </div>
    <img src="./img/grid.png"  class="bg-grid" />
    <img src="./img/sink.png"  class="bg-sink" />
</body>
<script>
    const images = document.querySelectorAll('.shelf img');
    const activeBowlImg = document.getElementById('activeBowl'); // The target bowl image
    const activeEffect = document.getElementById('activeEffect'); // The animation effect

    images.forEach(function(image) {
        image.addEventListener('click', function() {
            const imageId = this.id;

            const newSrc = `./img/${imageId}-active.png`;
            activeBowlImg.src = newSrc;
            activeBowlImg.dataset.name = this.dataset.name;
            activeBowlImg.dataset.id = imageId;

            if (newSrc) {
                activeEffect.style.display = 'block'; // Show animation effect
            }
        });
    });


    function goToNextPage() {
        const requiredItem = sessionStorage.getItem('formData');
        if (!requiredItem) {
            window.location.href = 'intro-form.html'; 
        }else { 
            if (activeBowlImg.src !== window.location.href) {

                let formData = sessionStorage.getItem('formData');
                if (formData) {
                    formData = JSON.parse(formData);
                    formData["รสชาติ"] = activeBowlImg.dataset.name;
                    formData["bowl"] = activeBowlImg.dataset.id;
                    sessionStorage.setItem('formData', JSON.stringify(formData)); 
                    window.location.href = 'step2.html';
                }
            }else { 
                alert("กรุณาเลือกรสชาติน้ำสลัดที่คุณชอบ");
            }
        }
    }
</script>
</html>
