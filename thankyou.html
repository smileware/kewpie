<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="icon" href="./img/fav.jpg" type="image/png" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kewpie Much & More เพราะคิวพีเป็นได้มากกว่าน้ำสลัด</title>
    <link rel="stylesheet" href="./style.css" />
    <link rel="stylesheet" href="./animate.css" />
  </head>
  <body class="page page-thankyou" onclick="goToNextPage()">
    <div class="wrapper">
      <img src="./img/logo.png" class="logo animate__animated animate__bounceIn" />
      <img src="./img/text-9.png" class="img-text animate__animated animate__bounceIn" />
    </div>
  </body>
  <img src="./img/end-table.png" class="bg-sink" />

  <script>
    let formData = sessionStorage.getItem('formData')
    const award = sessionStorage.getItem('award')

    if (formData) {
      formData = JSON.parse(formData)

      const dataToSheet = new FormData()
      dataToSheet.append('gender', formData.gender)
      dataToSheet.append('age', formData.age)
      dataToSheet.append('kewpie', formData.kewpie)
      dataToSheet.append('preference', formData.preference)
      dataToSheet.append('consent', formData.consent)
      dataToSheet.append('taste', formData['รสชาติ'])
      dataToSheet.append('bowl', formData.bowl)
      dataToSheet.append('menu', formData.menu)
      dataToSheet.append('award', award)
      const deployKey = 'AKfycbyYAOQhFMsJcQF2wXEl_rxob-UEzgvawvCA_zlGzNpu0VRw3A1ksHMhJiNWa6pt3vAn'
      const url = `https://script.google.com/macros/s/${deployKey}/exec`
      fetch(url, {
        method: 'POST',
        body: dataToSheet,
      })
        .then((response) => response.text())
        .then((data) => {
          console.log('Data submitted successfully')
        })
        .catch((error) => {
          console.error('Error:', error)
        })
    }

    function goToNextPage() {
      const restart = window.confirm('Do you want to start over?')

      if (restart) {
        window.location.href = 'index.html'
        sessionStorage.clear()
        localStorage.clear()
      }
    }
  </script>
</html>
